robust read write and read line

1 initialize the buffer first
2 then use the function 